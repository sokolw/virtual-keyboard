(()=>{"use strict";class t{static createDivElement(){return document.createElement("div")}static createSpanElement(){return document.createElement("span")}static createTextareaElement(){return document.createElement("textarea")}}class e{wrapper;constructor(){this.init()}get getWrapper(){return this.wrapper}init(){this.addWrapper()}addWrapper(){this.wrapper=t.createDivElement(),this.wrapper.classList.add("wrapper")}}class i{constructor(){this.codeKeyEnMap=new Map(this.codeKeyEnArray),this.shiftedCodeKeyEnMap=new Map(this.shiftedCodeKeyEnArray),this.codeKeyRuMap=new Map(this.codeKeyRuArray),this.shiftedCodeKeyRuMap=new Map(this.shiftedCodeKeyRuArray),this.codeKeyEnArray=null,this.shiftedCodeKeyEnArray=null,this.codeKeyRuArray=null,this.shiftedCodeKeyRuArray=null}codeKeyEnArray=[["Backquote","`"],["Digit1","1"],["Digit2","2"],["Digit3","3"],["Digit4","4"],["Digit5","5"],["Digit6","6"],["Digit7","7"],["Digit8","8"],["Digit9","9"],["Digit0","0"],["Minus","-"],["Equal","="],["Backspace","Backspace"],["Tab","Tab"],["KeyQ","q"],["KeyW","w"],["KeyE","e"],["KeyR","r"],["KeyT","t"],["KeyY","y"],["KeyU","u"],["KeyI","i"],["KeyO","o"],["KeyP","p"],["BracketLeft","["],["BracketRight","]"],["Backslash","\\"],["Delete","Del"],["CapsLock","CapsLock"],["KeyA","a"],["KeyS","s"],["KeyD","d"],["KeyF","f"],["KeyG","g"],["KeyH","h"],["KeyJ","j"],["KeyK","k"],["KeyL","l"],["Semicolon",";"],["Quote","'"],["Enter","Enter"],["ShiftLeft","Shift"],["KeyZ","z"],["KeyX","x"],["KeyC","c"],["KeyV","v"],["KeyB","b"],["KeyN","n"],["KeyM","m"],["Comma",","],["Period","."],["Slash","/"],["ArrowUp","⮝"],["ShiftRight","Shift"],["ControlLeft","Ctrl"],["MetaLeft","Win"],["AltLeft","Alt"],["Space"," "],["AltRight","Alt"],["ArrowLeft","⮜"],["ArrowDown","⮟"],["ArrowRight","⮞"],["ControlRight","Ctrl"]];shiftedCodeKeyEnArray=[["Backquote","~"],["Digit1","!"],["Digit2","@"],["Digit3","#"],["Digit4","$"],["Digit5","%"],["Digit6","^"],["Digit7","&"],["Digit8","*"],["Digit9","("],["Digit0",")"],["Minus","_"],["Equal","+"],["BracketLeft","{"],["BracketRight","}"],["Backslash","|"],["Semicolon",":"],["Quote",'"'],["Comma","<"],["Period",">"],["Slash","?"]];codeKeyRuArray=[["Backquote","ё"],["Digit1","1"],["Digit2","2"],["Digit3","3"],["Digit4","4"],["Digit5","5"],["Digit6","6"],["Digit7","7"],["Digit8","8"],["Digit9","9"],["Digit0","0"],["Minus","-"],["Equal","="],["Backspace","Backspace"],["Tab","Tab"],["KeyQ","й"],["KeyW","ц"],["KeyE","у"],["KeyR","к"],["KeyT","е"],["KeyY","н"],["KeyU","г"],["KeyI","ш"],["KeyO","щ"],["KeyP","з"],["BracketLeft","х"],["BracketRight","ъ"],["Backslash","\\"],["Delete","Del"],["CapsLock","CapsLock"],["KeyA","ф"],["KeyS","ы"],["KeyD","в"],["KeyF","а"],["KeyG","п"],["KeyH","р"],["KeyJ","о"],["KeyK","л"],["KeyL","д"],["Semicolon","ж"],["Quote","э"],["Enter","Enter"],["ShiftLeft","Shift"],["KeyZ","я"],["KeyX","ч"],["KeyC","с"],["KeyV","м"],["KeyB","и"],["KeyN","т"],["KeyM","ь"],["Comma","б"],["Period","ю"],["Slash","."],["ArrowUp","⮝"],["ShiftRight","Shift"],["ControlLeft","Ctrl"],["MetaLeft","Win"],["AltLeft","Alt"],["Space"," "],["AltRight","Alt"],["ArrowLeft","⮜"],["ArrowDown","⮟"],["ArrowRight","⮞"],["ControlRight","Ctrl"]];shiftedCodeKeyRuArray=[["Digit1","!"],["Digit2",'"'],["Digit3","№"],["Digit4",";"],["Digit5","%"],["Digit6",":"],["Digit7","?"],["Digit8","*"],["Digit9","("],["Digit0",")"],["Minus","_"],["Equal","+"],["Backslash","/"],["Slash",","]]}class a{keyboard;currentLanguageData;currentCaretPosition;toggle=!1;constructor(t=null,e="en"){this.keysData=new i,this.inputContainer=t.getInputContainer,this.textContainer=t,this.buttonsInContainer=new Map,this.language=e,this.virtualCommandCombineKeys=new Map([["CapsLock",!1],["ShiftLeft",!1],["ShiftRight",!1],["ControlLeft",!1],["ControlRight",!1],["MetaLeft",!1],["AltLeft",!1],["AltRight",!1]]),this.init()}init(){this.addLanguage(this.language),this.createKeyboardBox(),this.currentLanguageData[0].forEach(this.createKeys.bind(this)),this.createGlobalKeyHandlers()}createKeyboardBox(){this.keyboard=t.createDivElement(),this.keyboard.classList.add("keyboard","wrapper__keyboard")}createKeys(e,i){const a=t.createDivElement(),n=t.createSpanElement();this.buttonsInContainer.set(i,a),["Backspace","CapsLock","Enter","ShiftLeft","ShiftRight","ControlLeft","ControlRight","Space"].includes(i)?(a.classList.add("keyboard-button",`keyboard-button_${e.length<=1?"space":e.toLowerCase()}`),n.textContent=e,this.addKeyHandlers(a),a.setAttribute("data-id",`${i}`)):(a.classList.add("keyboard-button"),n.textContent=e,this.addKeyHandlers(a),a.setAttribute("data-id",`${i}`)),a.append(n),this.keyboard.append(a)}addKeyHandlers(t){t.addEventListener("mousedown",this.mousedownHandler.bind(this)),t.addEventListener("mouseup",this.mouseupHandler.bind(this)),t.addEventListener("mouseout",this.mouseoutHandler.bind(this))}createGlobalKeyHandlers(){window.addEventListener("keydown",this.keydownHandler.bind(this)),window.addEventListener("keyup",this.keyupHandler.bind(this))}keydownHandler(t){this.buttonsInContainer.has(t.code)&&(t.preventDefault(),this.virtualCommandCombineKeys.has(t.code)?"CapsLock"===t.code?this.toggleCapsLock(t):(this.activateButton(t),t.altKey&&t.shiftKey&&(this.virtualCommandCombineKeys.get("CapsLock")?(this.disableCapsLock("CapsLock"),this.updateKeyboardLanguage(),this.enableCapsLock("CapsLock")):this.updateKeyboardLanguage()),t.shiftKey&&!t.altKey&&this.toggleShift(t.code)):(this.activateButton(t),"Backspace"===t.code?this.textContainer.backspace():"Delete"===t.code?this.textContainer.delete():"Enter"===t.code?this.textContainer.enter():"Tab"===t.code?this.textContainer.tab():"ArrowUp"===t.code?this.textContainer.up():"ArrowDown"===t.code?this.textContainer.down():"ArrowLeft"===t.code?this.textContainer.left():"ArrowRight"===t.code?this.textContainer.right():this.textContainer.addChar(this.isModifiedKey(t.code)),this.inputContainer.scrollTop=this.inputContainer.scrollHeight,this.inputContainer.focus()))}keyupHandler(t){this.buttonsInContainer.has(t.code)&&"CapsLock"!==t.code&&(this.disableButton(t),this.virtualCommandCombineKeys.has(t.code)&&this.virtualCommandCombineKeys.get(t.code)&&this.toggleShift(t.code))}mousedownHandler(t){const e=t.currentTarget.getAttribute("data-id");this.buttonsInContainer.has(e)&&(this.virtualCommandCombineKeys.has(e)?"CapsLock"===e?this.toggleCapsLock({code:e}):(this.activateButton({code:e}),this.virtualCommandCombineKeys.get(e)?(this.virtualCommandCombineKeys.get("AltLeft")||this.virtualCommandCombineKeys.get("AltRight")||this.virtualCommandCombineKeys.get("ControlLeft")||this.virtualCommandCombineKeys.get("ControlRight"))&&(this.virtualCommandCombineKeys.set(e,!1),this.disableButton({code:e})):this.virtualCommandCombineKeys.set(e,!0),(this.virtualCommandCombineKeys.get("AltLeft")||this.virtualCommandCombineKeys.get("AltRight"))&&(this.virtualCommandCombineKeys.get("ShiftLeft")||this.virtualCommandCombineKeys.get("ShiftRight"))&&(this.virtualCommandCombineKeys.get("CapsLock")?(this.disableCapsLock("CapsLock"),this.updateKeyboardLanguage(),this.enableCapsLock("CapsLock"),this.comboDisable()):(this.updateKeyboardLanguage(),this.comboDisable())),this.virtualCommandCombineKeys.get("AltLeft")||this.virtualCommandCombineKeys.get("AltRight")||!this.virtualCommandCombineKeys.get("ShiftLeft")&&!this.virtualCommandCombineKeys.get("ShiftRight")||(this.virtualToggleShift(e),this.virtualCommandCombineKeys.get(e)||this.disableButton({code:e}))):(this.activateButton({code:e}),"Backspace"===e?this.textContainer.backspace():"Delete"===e?this.textContainer.delete():"Enter"===e?this.textContainer.enter():"Tab"===e?this.textContainer.tab():"ArrowUp"===e?this.textContainer.up():"ArrowDown"===e?this.textContainer.down():"ArrowLeft"===e?this.textContainer.left():"ArrowRight"===e?this.textContainer.right():this.textContainer.addChar(this.isModifiedKey(e)),this.inputContainer.scrollTop=this.inputContainer.scrollHeight,this.inputContainer.focus()))}mouseupHandler(t){const e=t.currentTarget.getAttribute("data-id");this.buttonsInContainer.has(e)&&"CapsLock"!==e&&"AltLeft"!==e&&"AltRight"!==e&&"ShiftLeft"!==e&&"ShiftRight"!==e&&"ControlLeft"!==e&&"ControlRight"!==e&&(this.disableButton({code:e}),this.virtualCommandCombineKeys.has(e)&&this.virtualCommandCombineKeys.get(e)&&this.toggleShift(e)),this.inputContainer.scrollTop=this.inputContainer.scrollHeight,this.inputContainer.focus()}mouseoutHandler(t){this.mouseupHandler(t)}toggleLanguage(t){"en"===t&&(this.language="ru",localStorage.setItem("language","ru"),this.currentLanguageData=[this.keysData.codeKeyRuMap,this.keysData.shiftedCodeKeyRuMap]),"ru"===t&&(this.language="en",localStorage.setItem("language","en"),this.currentLanguageData=[this.keysData.codeKeyEnMap,this.keysData.shiftedCodeKeyEnMap])}addLanguage(t){"en"===t&&(this.currentLanguageData=[this.keysData.codeKeyEnMap,this.keysData.shiftedCodeKeyEnMap]),"ru"===t&&(this.currentLanguageData=[this.keysData.codeKeyRuMap,this.keysData.shiftedCodeKeyRuMap])}updateKeyboardLanguage(){this.toggleLanguage(this.language),this.buttonsInContainer.forEach(this.updateKeys.bind(this))}updateKeys(t,e){t.firstChild.textContent=this.currentLanguageData[0].get(e)}toggleCapsLock(t){const e=t.code;"CapsLock"===e&&(this.virtualCommandCombineKeys.get(e)?(this.disableButton(t),this.virtualCommandCombineKeys.set(e,!1),this.virtualCommandCombineKeys.get("ShiftLeft")||this.virtualCommandCombineKeys.get("ShiftRight")?this.buttonsInContainer.forEach(this.updateShiftKeys.bind(this)):this.buttonsInContainer.forEach(this.updateCapsKeys.bind(this))):(this.activateButton(t),this.virtualCommandCombineKeys.set(e,!0),this.virtualCommandCombineKeys.get("ShiftLeft")||this.virtualCommandCombineKeys.get("ShiftRight")?this.buttonsInContainer.forEach(this.updateOnlyShiftKeys.bind(this)):this.buttonsInContainer.forEach(this.updateCapsKeys.bind(this))))}disableCapsLock(t){"CapsLock"===t&&(this.buttonsInContainer.get(t).classList.contains("active")&&this.buttonsInContainer.get(t).classList.remove("active"),this.virtualCommandCombineKeys.set(t,!1),this.buttonsInContainer.forEach(this.updateCapsKeys.bind(this)))}enableCapsLock(t){"CapsLock"===t&&(this.buttonsInContainer.get(t).classList.contains("active")||this.buttonsInContainer.get(t).classList.add("active"),this.virtualCommandCombineKeys.set(t,!0),this.buttonsInContainer.forEach(this.updateCapsKeys.bind(this)))}activateButton(t){this.buttonsInContainer.get(t.code).classList.contains("active")||this.buttonsInContainer.get(t.code).classList.add("active")}disableButton(t){this.buttonsInContainer.get(t.code).classList.contains("active")&&this.buttonsInContainer.get(t.code).classList.remove("active")}updateCapsKeys(t,e){1===this.currentLanguageData[0].get(e).length&&this.virtualCommandCombineKeys.get("CapsLock")?t.firstChild.textContent=this.currentLanguageData[0].get(e).toUpperCase():1===this.currentLanguageData[0].get(e).length&&(t.firstChild.textContent=this.currentLanguageData[0].get(e))}isModifiedKey(t){return!this.virtualCommandCombineKeys.get("CapsLock")||this.virtualCommandCombineKeys.get("ShiftLeft")||this.virtualCommandCombineKeys.get("ShiftRight")?!this.virtualCommandCombineKeys.get("ShiftLeft")&&!this.virtualCommandCombineKeys.get("ShiftRight")||this.virtualCommandCombineKeys.get("CapsLock")?(this.virtualCommandCombineKeys.get("ShiftLeft")||this.virtualCommandCombineKeys.get("ShiftRight"))&&this.virtualCommandCombineKeys.get("CapsLock")&&this.currentLanguageData[1].has(t)?this.currentLanguageData[1].get(t):this.currentLanguageData[0].get(t):this.currentLanguageData[1].has(t)?this.currentLanguageData[1].get(t):this.currentLanguageData[0].get(t).toUpperCase():this.currentLanguageData[0].get(t).toUpperCase()}virtualToggleShift(t){!this.virtualCommandCombineKeys.get(t)||this.virtualCommandCombineKeys.get("CapsLock")||this.toggle?this.virtualCommandCombineKeys.get(t)&&!this.virtualCommandCombineKeys.get("CapsLock")&&this.toggle?(this.toggle=!1,this.virtualCommandCombineKeys.set(t,!1),this.buttonsInContainer.forEach(this.updateKeys.bind(this))):this.virtualCommandCombineKeys.get(t)&&this.virtualCommandCombineKeys.get("CapsLock")&&!this.toggle?(this.toggle=!0,this.buttonsInContainer.forEach(this.updateOnlyShiftKeys.bind(this))):this.virtualCommandCombineKeys.get(t)&&this.virtualCommandCombineKeys.get("CapsLock")&&this.toggle&&(this.toggle=!1,this.virtualCommandCombineKeys.set(t,!1),this.buttonsInContainer.forEach(this.updateCapsKeys.bind(this))):(this.toggle=!0,this.buttonsInContainer.forEach(this.updateShiftKeys.bind(this)))}toggleShift(t){this.virtualCommandCombineKeys.get(t)||this.virtualCommandCombineKeys.get("CapsLock")?this.virtualCommandCombineKeys.get(t)&&!this.virtualCommandCombineKeys.get("CapsLock")?(this.virtualCommandCombineKeys.set(t,!1),this.buttonsInContainer.forEach(this.updateKeys.bind(this))):!this.virtualCommandCombineKeys.get(t)&&this.virtualCommandCombineKeys.get("CapsLock")?(this.virtualCommandCombineKeys.set(t,!0),this.buttonsInContainer.forEach(this.updateOnlyShiftKeys.bind(this))):this.virtualCommandCombineKeys.get(t)&&this.virtualCommandCombineKeys.get("CapsLock")&&(this.virtualCommandCombineKeys.set(t,!1),this.buttonsInContainer.forEach(this.updateCapsKeys.bind(this))):(this.virtualCommandCombineKeys.set(t,!0),this.buttonsInContainer.forEach(this.updateShiftKeys.bind(this)))}updateShiftKeys(t,e){const i=t;this.currentLanguageData[1].has(e)?i.firstChild.textContent=this.currentLanguageData[1].get(e):1===this.currentLanguageData[0].get(e).length&&(i.firstChild.textContent=this.currentLanguageData[0].get(e).toUpperCase())}updateOnlyShiftKeys(t,e){const i=t;this.currentLanguageData[1].has(e)?i.firstChild.textContent=this.currentLanguageData[1].get(e):1===this.currentLanguageData[0].get(e).length&&(i.firstChild.textContent=this.currentLanguageData[0].get(e))}comboDisable(){this.disableButton({code:"AltLeft"}),this.disableButton({code:"AltRight"}),this.disableButton({code:"ShiftLeft"}),this.disableButton({code:"ShiftRight"}),this.virtualCommandCombineKeys.set("AltLeft",!1),this.virtualCommandCombineKeys.set("AltRight",!1),this.virtualCommandCombineKeys.set("ShiftLeft",!1),this.virtualCommandCombineKeys.set("ShiftRight",!1)}}class n{currentPositionCaret;CURRENT_LENGTH_ROW=54;constructor(){this.charVault=[],this.inputContainer=n.createInputContainer()}get getInputContainer(){return this.inputContainer}static createInputContainer(){const e=t.createTextareaElement();return e.classList.add("textarea","input-window__textarea"),e}addChar(t){this.getCurrentPositionCaret()===this.charVault.length?(this.charVault.push(t),this.updateCurrentPositionCaret(this.getCurrentPositionCaret()+1),this.updateTextContainer()):(this.charVault.splice(this.getCurrentPositionCaret(),0,t),this.updateCurrentPositionCaret(this.getCurrentPositionCaret()+1),this.updateTextContainer())}updateCurrentPositionCaret(t){this.currentPositionCaret=t}getCurrentPositionCaret(){return this.inputContainer.selectionStart}updateCurrentPositionCaretOfContainer(){this.inputContainer.setSelectionRange(this.currentPositionCaret,this.currentPositionCaret)}updateTextContainer(){this.inputContainer.textContent=this.charVault.join(""),this.inputContainer.setSelectionRange(this.currentPositionCaret,this.currentPositionCaret)}backspace(){this.getCurrentPositionCaret()===this.charVault.length?(this.charVault.pop(),this.updateCurrentPositionCaret(this.getCurrentPositionCaret()),this.updateTextContainer()):this.getCurrentPositionCaret()-1>-1&&(this.charVault.splice(this.getCurrentPositionCaret()-1,1),this.updateCurrentPositionCaret(this.getCurrentPositionCaret()-1),this.updateTextContainer())}delete(){this.getCurrentPositionCaret()!==this.charVault.length&&(this.charVault.splice(this.getCurrentPositionCaret(),1),this.updateCurrentPositionCaret(this.getCurrentPositionCaret()),this.updateTextContainer())}enter(){this.addChar("\n")}tab(){for(let t=0;t<4;t+=1)this.addChar(" ")}up(){const t=this.charVault.slice(0,this.getCurrentPositionCaret()).join("").split("\n");if(1===t.length)this.updateCurrentPositionCaret(this.getCurrentPositionCaret()-this.CURRENT_LENGTH_ROW);else if(t[t.length-1].length>this.CURRENT_LENGTH_ROW)this.updateCurrentPositionCaret(this.getCurrentPositionCaret()-this.CURRENT_LENGTH_ROW);else if(t[t.length-1].length<t[t.length-2].length){const e=this.getCurrentPositionCaret()-(t[t.length-2].length-t[t.length-1].length+t[t.length-1].length)-1;this.updateCurrentPositionCaret(e)}else{const e=this.getCurrentPositionCaret()-t[t.length-1].length-1;this.updateCurrentPositionCaret(e)}this.currentPositionCaret>=0&&this.updateCurrentPositionCaretOfContainer()}down(){const t=this.charVault.slice(0,this.getCurrentPositionCaret()).join("").split("\n"),e=this.charVault.slice(this.getCurrentPositionCaret()).join("").split("\n");if(1===e.length)this.updateCurrentPositionCaret(this.getCurrentPositionCaret()+this.CURRENT_LENGTH_ROW);else if(e[0].length>this.CURRENT_LENGTH_ROW)this.updateCurrentPositionCaret(this.getCurrentPositionCaret()+this.CURRENT_LENGTH_ROW);else if(e[0].length<e[1].length){const i=this.getCurrentPositionCaret()+(e[0].length+t[t.length-1].length)+1;this.updateCurrentPositionCaret(i)}else{const i=this.getCurrentPositionCaret()+(e[0].length+t[t.length-1].length)+1;this.updateCurrentPositionCaret(i)}this.currentPositionCaret>0&&this.updateCurrentPositionCaretOfContainer()}left(){this.getCurrentPositionCaret()>0&&(this.updateCurrentPositionCaret(this.getCurrentPositionCaret()-1),this.updateCurrentPositionCaretOfContainer())}right(){this.getCurrentPositionCaret()>-1&&(this.updateCurrentPositionCaret(this.getCurrentPositionCaret()+1),this.updateCurrentPositionCaretOfContainer())}}class s{environment;language;constructor(){this.init()}init(){this.environment=new e,this.language=s.loadLanguage(),this.run()}run(){const e=this.environment.getWrapper;document.body.append(e);const i=t.createDivElement();i.classList.add("description","wrapper__description");const s=t.createDivElement();s.classList.add("input-window","wrapper__input-window"),e.append(i),e.append(s);let o=document.createElement("h1");o.classList.add("description__title"),o.textContent="Virtual keyboard",i.append(o),o=document.createElement("p"),o.classList.add("description__requirement"),o.textContent="The keyboard was created in OS Windows 10, GoogleChrome v100",i.append(o),o=document.createElement("p"),o.classList.add("description__language"),o.textContent="To switch the language, use the keyboard shortcut Alt + Shift",i.append(o);const r=new n;s.append(r.getInputContainer);const h=new a(r,null!==this.language?this.language:"en");e.append(h.keyboard)}static loadLanguage(){return window.localStorage.getItem("language")}}setTimeout((function(){window.app={run:new s}}),100)})();